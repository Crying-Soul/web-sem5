extends ../layout

block content
  .book-detail
    .book-header
      h1.book-title= book.title
      p.book-author автор: #{book.author}

    .book-body
      .book-info-grid
        .info-section
          h3 Информация о книге
          .info-item
            strong Название:
            span= book.title
          .info-item
            strong Автор:
            span= book.author
          .info-item
            strong Дата публикации:
            - const pubDate = book.publicationDate ? new Date(book.publicationDate).toLocaleDateString('ru-RU') : ''
            span= pubDate
          .info-item
            strong ISBN:
            span= book.isbn
          .info-item
            strong Статус:
            span.status-badge(class=book.status, style="margin-left: 0.5rem;")= book.status === 'available' ? 'Доступна' : 'Взята'

        .info-section
          h3 Обложка
          if book.coverImage
            img(
              src=book.coverImage, 
              alt=book.title,
              style="max-width: 200px; border-radius: 8px;"
            )
          else
            .empty-state(style="padding: 2rem;")
              i.fas.fa-image
              p Нет обложки

      if book.status === 'borrowed'
        .borrow-info(class=book.isOverdue ? 'overdue' : '')
          - const titleColor = book.isOverdue ? '#e63946' : '#f72585'
          h3(style="color: " + titleColor + ";") Информация об аренде
          .info-item
            strong Читатель:
            span= book.borrower
          .info-item
            strong Дата взятия:
            - const borrowDate = book.borrowDate ? new Date(book.borrowDate).toLocaleDateString('ru-RU') : ''
            span= borrowDate
          .info-item
            strong Дата возврата:
            - const dueDate = book.dueDate ? new Date(book.dueDate).toLocaleDateString('ru-RU') : ''
            span= dueDate
          if book.isOverdue
            .info-item
              strong Статус:
              span.status-badge.overdue ПРОСРОЧЕНА

      .action-buttons(style="display: flex; gap: 1rem; margin-top: 2rem; flex-wrap: wrap;")
        if book.status === 'available'
          button.btn.btn-primary(
            onclick=`window.openBorrowModal('${book.id}', '${book.title.replace(/'/g, "\\'")}')`
          )
            i.fas.fa-hand-holding
            | Взять книгу
        else
          button.btn.btn-success(
            onclick=`window.returnBook('${book.id}')`
          )
            i.fas.fa-undo
            | Вернуть книгу
        
        a.btn.btn-outline(href=`/books/${book.id}/edit`)
          i.fas.fa-edit
          | Редактировать
        
        a.btn.btn-outline(href="/books")
          i.fas.fa-arrow-left
          | Назад к книгам